  <!DOCTYPE html>
<html lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns# :cc http://creativecommons.org/ns#">
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FQL01W176"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FQL01W176');
</script>


    <meta charset="utf-8">
    <title>A new version of analogue for a new year</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Gavin Simpson">
    
    
<!-- HTML5 metadata -->

<meta name="keywords" content="analogue, Palaeoecology, Palaeolimnology, R, Statistics" />


<meta name="description" content="Yesterday I rolled up a new version (0.10-0) of [analogue](http://cran.r-project.org/web/packages/analogue/index.html), my R package for analysing palaeoecological data. It is now available from CRAN. There were lots of incremental changes to `Stratiplot()` to improve the quality of the stratigraphic diagrams produced and fix several annoying bugs. Also the definition of the standard error of MAT reconstructions was fixed; it is essentially a weighted variance but the original version assumed the weights summed to 1, which is not the case for dissimilarities of the *k*-NN. Several new functions and additional functionality were added to the package." />

<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="A new version of analogue for a new year" />
<meta property="dc:creator" content="Gavin Simpson" />

<meta property="dc:date" content="2013-01-04T00:00:00+01:00" />

<meta property="dc:type" content="" /> <!-- article? entry?-->
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:source" content="From the Bottom of the Heap" />
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="A new version of analogue for a new year" />
<meta property="og:author" content="http://localhost:4000/about/" />
<meta property="http://ogp.me/ns/profile#first_name" content="Gavin"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Simpson"/>

<meta property="http://ogp.me/ns/article#published_time" content="2013-01-04T00:00:00+01:00" />

<meta property="og:site_name" content="From the Bottom of the Heap" />
<meta property="og:url" content="http://localhost:4000/2013/01/04/a-new-version-of-analogue-for-a-new-year/" />
<meta property="og:type" content="article" />

<meta name="og:description" content="Yesterday I rolled up a new version (0.10-0) of [analogue](http://cran.r-project.org/web/packages/analogue/index.html), my R package for analysing palaeoecological data. It is now available from CRAN. There were lots of incremental changes to `Stratiplot()` to improve the quality of the stratigraphic diagrams produced and fix several annoying bugs. Also the definition of the..." />

<!-- Twitter Card Meta data -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site.id" content="@ucfagls" />
<meta name="twitter:creator:id" content="@ucfagls" />
<meta name="twitter:title" content="A new version of analogue for a new year" />


<meta name="twitter:description" content="Yesterday I rolled up a new version (0.10-0) of [analogue](http://cran.r-project.org/web/packages/analogue/index.html), my R package for analysing palaeoecological data. It is now available from C..." />

<!-- Google Scholar Metadata -->
<meta name="resource_type" content="From the Bottom of the Heap"/>
<meta name="citation_journal_title" content="From the Bottom of the Heap"/>

<meta name="citation_publication_date" content="04 Jan 2013"/>
<meta name="citation_date" content="04 Jan 2013"/>

<meta name="citation_author" content="Gavin Simpson"/>
<meta name="citation_title" content="A new version of analogue for a new year"/>

    
    <!-- Link to the Atom feeds -->
    <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="From the bottom of the heap ATOM feed">
    <link href="http://localhost:4000/feed-R.xml" type="application/atom+xml" rel="alternate" title="From the bottom of the heap ATOM feed of R posts">
    
    <!-- Le styles -->
    <link href="http://localhost:4000/assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
    </style>
    <link href="http://localhost:4000/assets/css/pyg_monokai.css" rel="stylesheet">
    <link href="http://localhost:4000/assets/css/ftboth.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://localhost:4000/assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="http://localhost:4000/assets/ico/apple-touch-icon-57-precomposed.png">
    
    <script data-ad-client="ca-pub-2908943772231164" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </head>

  <body>

      <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://localhost:4000">From the bottom of the heap</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li ><a href="http://localhost:4000"><i class="icon-home"></i> Home</a></li>
              <li ><a href="http://localhost:4000/about/"><i class="icon-info-sign"></i> About</a></li>
              <li class="active"><a href="http://localhost:4000/blog/"><i class="icon-comment"></i> Blog</a></li>
              <li ><a href="http://localhost:4000/publications/"><i class="icon-file"></i> Publications</a></li>
              <li ><a href="http://localhost:4000/research/"><i class="icon-wrench"></i> Research</a></li>
              <li  class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="icon-filter"></i> The Lab <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a tabindex="-1" href="http://localhost:4000/lab/">About</a></li>
                  <li><a tabindex="-1" href="http://localhost:4000/lab/research/">Research</a></li>
                  <li><a tabindex="-1" href="http://localhost:4000/lab/members/">Members</a></li>
                  <li><a tabindex="-1" href="http://localhost:4000/lab/publications">Publications</a></li>
                  <li><a tabindex="-1" href="http://localhost:4000/lab/join/">Join the lab</a></li>
                </ul>
              </li>
              <li  class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="icon-filter"></i> Resources <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a tabindex="-1" href="http://localhost:4000/teaching/">Teaching</a></li>
                  <li><a tabindex="-1" href="http://localhost:4000/workshops/">Workshops</a></li>
                  <li><a tabindex="-1" href="http://localhost:4000/slides/">Slides</a></li>
                </ul>
              </li>
              <li  class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-hdd"></i> Code <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li class="dropdown-submenu">
                    <a tabindex="-1" href="http://localhost:4000/code/dper-scripts/">DPER Scripts</a>
                    <ul class="dropdown-menu">
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/dper-scripts/chapter-9-statistical-learning/">Chapter 9</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/dper-scripts/chapter-15-analogue-methods/">Chapter 15</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/dper-scripts/chapter-19-human-impacts/">Chapter 19</a>
                      </li>
                    </ul>
                  </li>
                  <li class="dropdown-submenu">
                    <a tabindex="-1" href="http://localhost:4000/code/r-packages">R Packages</a>
                    <ul class="dropdown-menu">
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/analogue/">analogue</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/permute/">permute</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/vegan/">vegan</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/gratia/">gratia</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/cocorresp/">cocorresp</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/coenocliner/">coenocliner</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/temporalEF/">temporalEF</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/canadaHCD/">canadaHCD</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/ggvegan/">ggvegan</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="http://localhost:4000/code/r-packages/pcurve/">pcurve</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>


    <div class="container">
          

      <article>
      <div class="row">
        <!-- <div class="span8 offset2"> -->
        <div class="span10">
          <div class="clearfix">
            <span class="post-nav"><i class="icon-arrow-left"></i> <a href="http://localhost:4000/2013/01/05/monotonic-deshrinking-in-weighted-averaging-models/">Monotonic deshrinking in weighted averaging models</a></span>
            <span class="post-nav" style="float: right;"><a href="http://localhost:4000/2012/08/15/processing-sample-labels-using-regular-expressions-in-r/">Processing sample labels using regular expressions in R</a> <i class="icon-arrow-right"></i></span>
          </div>
          <div class="page-header">
            <header>
              <h1>A new version of analogue for a new year </h1>
            </header>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="span12">
          <div class="row">
            <div class="span10">
              
            <p>
Yesterday I rolled up a new version (0.10-0) of <a href="http://cran.r-project.org/web/packages/analogue/index.html">analogue</a>, my R package for analysing palaeoecological data. It is now available from CRAN. There were lots of incremental changes to <code>Stratiplot()</code> to improve the quality of the stratigraphic diagrams produced and fix several annoying bugs. Also the definition of the standard error of MAT reconstructions was fixed; it is essentially a weighted variance but the original version assumed the weights summed to 1, which is not the case for dissimilarities of the <em>k</em>-NN. Several new functions and additional functionality were added to the package.
</p>
<ul>
<li><code>caterpillarPlot()</code> produces caterpillar plots showing species WA optima and tolerance ranges</li>
<li><code>splitSample()</code> is a convenience function for sampling a subset of training set samples whilst ensuring that the entire environmental gradient of interest in the training set is evenly sampled.</li>
<li>The <code>wa()</code> function received a lot of love in this iteration. The main addition is to allow non-linear deshrinking of the raw WA estimates alongside the more common inverse and classical deshrinking techniques. The deshrinking is achieved using a cubic regression spline fitted using the <code>gam()</code> function in package <a href="http://cran.r-project.org/web/packages/mgcv/index.html">mgcv</a>. The spline is constrained to be monotonic to make sure that the deshrunk values for increasing raw values are likewise increasing. Small tolerance handling in <code>wa()</code> with tolerance downweighting gained the option to replace small tolerances with the mean of all taxon tolerances.</li>
<li><code>logitreg()</code>, which applies a logistic regression to the problem of identifying a critical threshold in compositional dissimilarity for MAT models, saw a major update. The returned object was substantially altered to allow for a wider amount of information to be supplied to the user. <code>fitted()</code> and <code>predict()</code> methods for class <code>"logitreg"</code> were also added. These compute the fitted probabilities for the training set samples and for new (e.g. fossil) samples respectively. The probabilities are in respect to the analogue-ness of samples to the groups in the training set (e.g. vegetation biomes in the case of pollen data). These changes allow an analysis similar in spirit to that of <a href="http://dx.doi.org/10.1016/S0033-5894(03)00088-7">Gavin et al (2003, Quaternary Research 60; 356–367)</a> in their Figure 8. Here though logistic regression fits are used and not the ROC method they use.</li>
</ul>
<p>I’ll be writing more on these ideas, especially the monotonic deshrinking and the logistic regression approach to dissimilarity threshold choice in future posts.</p>

            <hr />
            <h3>Comments</h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = "fromthebottomoftheheap";
  var disqus_url = "https://www.fromthebottomoftheheap.net/2013/01/04/a-new-version-of-analogue-for-a-new-year/";
  var disqus_title = "A new version of analogue for a new year";
  //var disqus_identifier = "/2013/01/04/a-new-version-of-analogue-for-a-new-year";

  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


            </div>
            <div class="span2">
                            <div class="side-snippet">
                <h4>By Gavin Simpson</h4>
              
                <h4>04 January 2013</h4>
              
              </div>

                            <div class="side-snippet">
                <h4>Posted in</h4>
                
                <a href="http://localhost:4000/category/r/"><span class="label label-warning">R</span></a><br>
                
              </div>
       

                            <div class="side-snippet">
                <h4>Tagged</h4>
                
                  <a href="http://localhost:4000/tag/analogue/"><span class="label label-inverse">analogue</span></a><br>
                
                  <a href="http://localhost:4000/tag/palaeoecology/"><span class="label label-inverse">Palaeoecology</span></a><br>
                
                  <a href="http://localhost:4000/tag/palaeolimnology/"><span class="label label-inverse">Palaeolimnology</span></a><br>
                
                  <a href="http://localhost:4000/tag/r/"><span class="label label-inverse">R</span></a><br>
                
                  <a href="http://localhost:4000/tag/statistics/"><span class="label label-inverse">Statistics</span></a><br>
                
              </div>

                          <div class="side-snippet">
              <h4>Social</h4>
              <p><a href="https://www.buymeacoffee.com/gavinsimpson" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 45px !important;width: 150px !important;" ></a></p>
              <p><img class="bs-icon addToolTip" data-original-title="Send me an email" data-placement="left" data-animation="true" src="http://localhost:4000/assets/img/glyphicons/glyphicons_419_e-mail.png" /> <a href="mailto:ucfagls@gmail.com">ucfagls@gmail.com</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="My twitter profile" data-placement="left" data-animation="true" src="http://localhost:4000/assets/img/glyphicons/glyphicons_411_twitter.png" /> <a href="https://twitter.com/ucfagls">@ucfagls</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="My github profile" data-placement="left" data-animation="true" src="http://localhost:4000/assets/img/glyphicons/glyphicons_401_github.png" /> <a href="https://github.com/gavinsimpson">gavinsimpson</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="ORCID ID" data-placement="left" data-animation="true" src="http://localhost:4000/assets/img/orcid_24x24.png" /> <a href="https://orcid.org/0000-0002-9084-8413">ORCID iD</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="Subscribe to the blog via RSS (Atom)" data-placement="left" data-animation="true" src="http://localhost:4000/assets/img/glyphicons/glyphicons_417_rss.png" /> <a href="http://localhost:4000/feed.xml" type="application/atom+xml">Subscribe</a></p>
            </div>


                          <div class="side-snippet">
              <h4>Blogroll</h4>
              <ul class="unstyled">
                <li><i class="icon-bookmark"></i> <a href="http://downwithtime.wordpress.com/">Down With time</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://contemplativemammoth.wordpress.com/">The Contemplative Mammoth</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://dynamicecology.wordpress.com/">Dynamic Ecology</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://jabberwocky.weecology.org/">Jabberwocky Ecology</a></li>
                <li><i class="icon-bookmark"></i> <a href="https://recology.info/">Recology</a></li>
                <li><i class="icon-bookmark"></i> <a href="https://rweekly.org/">R Weekly</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://www.r-bloggers.com/">R Bloggers</a></li>
                <li><i class="icon-bookmark"></i> <a href="https://methodsblog.wordpress.com/">Methods in Ecology &amp; Evolution</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://quantpalaeo.wordpress.com/">Musings on Quantitative Palaeoecology</a></li>
              </ul>
            </div>

              
            </div>
          </div>
        </div>
      </div>
      </article>

        

    </div><!--/.fixed-container-->
    
    <footer>
      <div class="container">
        <div class="row">
          <div class="span2">
            <h4>Menu</h4>
            <ul class="unstyled">
              <li><a href="http://localhost:4000"><small>Home</small></a></li>
              <li><a href="http://localhost:4000/about/"><small>About</small></a></li>
              <li><a href="http://localhost:4000/publications/"><small>Publications</small></a></li>
              <li><a href="http://localhost:4000/research/"><small>Research</small></a></li>
              <li><a href="http://localhost:4000/lab/"><small>The Lab</small></a></li>
              <li><a href="http://localhost:4000/teaching/"><small>Teaching</small></a></li>
              <li><a href="http://localhost:4000/code/dper-scripts/"><small>DPER Scripts</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/"><small>R Packages</small></a></li>
            </ul>
          </div>
          <div class="span2">
            <h4>R packages</h4>
            <ul class="unstyled">
              <li><a href="http://localhost:4000/code/r-packages/analogue/"><small>analogue</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/permute/"><small>permute</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/vegan/"><small>vegan</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/gratia/"><small>gratia</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/cocorresp/"><small>cocorresp</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/coenocliner/"><small>coenocliner</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/temporalEF/"><small>temporalEF</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/canadaHCD/"><small>canadaHCD</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/ggvegan/"><small>ggvegan</small></a></li>
              <li><a href="http://localhost:4000/code/r-packages/pcurve/"><small>pcurve</small></a></li>
            </ul>        
          </div>
          <div class="span6">
            <h4>Fineprint</h4>
            <p><small>Copyright &copy; 2010&ndash;2024 Gavin Simpson. <a href="http://localhost:4000/permissions/">Some Rights Reserved</a>&nbsp;&nbsp;&nbsp;<a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://licensebuttons.net/l/by/4.0/80x15.png" /></a></small></p>
            <p><small>Icons by <a href="http://www.glyphicons.com/">Glyphicons</a> used under CC-BY licence</small></p>
          </div>
        </div>
      </div>
    </footer>
    
        <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://localhost:4000/assets/js/jquery.min.js"></script>
    <script src="http://localhost:4000/assets/js/bootstrap.js"></script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        jQuery(function ($) {
            $(".addToolTip").tooltip()
        });
        // Fix suggested by Dependabot as I don't think i can upgrade to jq >=3.5.0 with this version of bootstrap
        jQuery.htmlPrefilter = function( html ) {
	return html;
	};
    </script>
    
    


  </body>
</html>


