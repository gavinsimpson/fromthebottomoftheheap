<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Dr. Gavin Simpson and Dr. Maria Davis" />


<title>Plant Physiology Lab</title>

<script src="lab-analysis_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="lab-analysis_files/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="lab-analysis_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="lab-analysis_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="lab-analysis_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="lab-analysis_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="lab-analysis_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="lab-analysis_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="lab-analysis_files/navigation-1.1/tabsets.js"></script>
<script src="lab-analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7900310-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-7900310-7');
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Plant Physiology Lab</h1>
<h4 class="author">Dr. Gavin Simpson and Dr. Maria Davis</h4>
<h4 class="date">October 2020</h4>

</div>


<div id="this-file-is-hosted-at-bit.lybiol266f19" class="section level4">
<h4>This file is hosted at: <a href="http://bit.ly/biol266f19">bit.ly/biol266f19</a></h4>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>To get started, open your web browser, head to <a href="">rstudio.cloud</a> and log in using your RStudio Cloud account.</p>
<p>Once you have logged in, start a <strong>New Project</strong> by clicking the button to the right of “Your Projects”</p>
<p><img src="images/rstudio-cloud-new-project-annotated.png" width="800px" /></p>
<p>After you click the button, <strong>rstudio.cloud</strong> will deploy a new RStudio instance, which may take a minute or two, so be patient.</p>
<p>Once the RStudio instance is running, rename your project by clicking on the “Untitled Project” label at the top of the screen. Give the project a useful name, such as “biol 266”.</p>
<p><img src="images/rstudio-cloud-change-project-name-annotated.png" width="450px" /></p>
<div id="opening-a-new-script-window" class="section level2">
<h2>Opening a new script window</h2>
<p>It is good practice to enter your R code into a R script. An R script is a plain text file that we save with the extension <code>.R</code>. All your code for the lab should go in here because</p>
<ol style="list-style-type: decimal">
<li>you can save the file and all your work as you go along so you have a record of what you did,</li>
<li>it is easier to edit your code and fix errors, mistakes, or typos in the script window, and</li>
<li>you can share the script file if you need help to track down an error.</li>
</ol>
<p>To start a new script, go to the <strong>File</strong> menu, then select <strong>New File</strong> &gt; <strong>R Script</strong></p>
<p><img src="images/rstudio-cloud-new-script.png" width="500px" /></p>
<p>Or you can press <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Alt</kbd> + <kbd>N</kbd> on Windows or <kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>Option</kbd> + <kbd>N</kbd> on a Mac.</p>
<p>Your RStudio screen should look like this</p>
<p><img src="images/rstudio-cloud-screen-annotated.png" width="750px" /></p>
</div>
<div id="installing-r-packages" class="section level2">
<h2>Installing R Packages</h2>
<p>Once you have a new session running and named, click in the Console window by the <strong>prompt</strong> and run the code below by typing in the console exactly what is shown below and hitting <kbd>Return</kbd></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&#39;readxl&#39;</span>, <span class="st">&#39;tidyr&#39;</span>, <span class="st">&#39;dplyr&#39;</span>, <span class="st">&#39;forcats&#39;</span>, <span class="st">&#39;ggplot2&#39;</span>, <span class="st">&#39;emmeans&#39;</span>))</span></code></pre></div>
<p>This will take a few minutes to complete.</p>
</div>
<div id="load-packages" class="section level2">
<h2>Load Packages</h2>
<p>We need to load the packages we just installed so they are ready to use. You need to do this each time you start R and want to use these packages. The installation step you just performed does <em>not</em> need to be each time you start R.</p>
<p>Click in the <strong>script</strong> window. Enter the lines of code below into the script window. The hash character <code>#</code> allows you to enter comments, which R will ignore.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(<span class="st">&#39;readxl&#39;</span>)  <span class="co"># read from Excel sheets</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(<span class="st">&#39;tidyr&#39;</span>)   <span class="co"># data processing</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(<span class="st">&#39;dplyr&#39;</span>)   <span class="co"># mo data processing</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">library</span>(<span class="st">&#39;forcats&#39;</span>) <span class="co"># mo mo data processing</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>) <span class="co"># plotting</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">library</span>(<span class="st">&#39;emmeans&#39;</span>) <span class="co"># for post hoc comparisons</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>()) <span class="co"># Set plot theme</span></span></code></pre></div>
<p>Once you have entered all those lines of code into the script window, move the cursor to the first line or click on it, and then press the following keys:</p>
<ul>
<li>On Windows press <kbd>Ctrl</kbd> + <kbd>Enter</kbd></li>
<li>On Mac press <kbd>Cmd</kbd> + <kbd>Enter</kbd></li>
</ul>
<p>This will send the current line of code to the <strong>console</strong> window and move cursor to the start of the next line. Continue hitting <kbd>Ctrl</kbd> + <kbd>Enter</kbd> or <kbd>Cmd</kbd> + <kbd>Enter</kbd> until you have sent each line of code into the console. As you do so, R will load each package; some messages will be printed to the console, but this is OK as long as you do not see any <strong>Errors</strong>.</p>
<p>From now on, enter the code in the shaded grey boxes into the <strong>Script</strong> window and use <kbd>Ctrl</kbd> + <kbd>Enter</kbd> or <kbd>Cmd</kbd> + <kbd>Enter</kbd> to send the code to the <strong>Console</strong>. Whenever R produces output, it should match (or be similar to; you will see output for your data) the text shown in the outlined boxes where each line starts with <code>##</code>.</p>
<p><em>Note that the output in the console <strong>won’t</strong> have the</em> <code>##</code><em>, these are just to indicate <strong>output</strong> in this document.</em></p>
</div>
<div id="upload-data" class="section level2">
<h2>Upload data</h2>
<p>Before we can work with the data from the experiment, we will need to upload them to our <strong>rstudio.cloud</strong> project. Make sure you have downloaded the <code>f19ph.xlsx</code> file from UR Courses and that you have it somewhere on your local computer. Next, make sure the <strong>Files</strong> tab is selected in the lower right quarter of the application, and locate the <strong>Upload</strong> button</p>
<p><img src="images/rstudio-cloud-screen-upload-button.png" width="750px" /></p>
<p>Click the <strong>Upload</strong> button — this will bring up the <strong>Upload files</strong> dialogue box</p>
<p><img src="images/rstudio-cloud-screen-upload-dialog.png" width="350px" /></p>
<p>Click the <strong>Choose file</strong> button — this will bring up the file chooser on your computer. In the file chooser, navigate to where you saved the <code>f19ph.xlsx</code> file and open it in the chooser so that the file is listed next to the <strong>Choose file</strong> button, as shown below</p>
<p><img src="images/rstudio-cloud-screen-upload-dialog-filled.png" width="350px" /></p>
<p>Once you have <code>f19ph.xlsx</code> showing in the dialogue box, you can click <strong>OK</strong> to upload the file to <strong>rstudio.cloud</strong>.</p>
<p>When you have uploaded the file, your <strong>Files</strong> pane should list the <code>f19ph.xlsx</code> file as shown below</p>
<p><img src="images/rstudio-cloud-screen-upload-complete.png" width="750px" /></p>
</div>
<div id="saving-your-work" class="section level2">
<h2>Saving your work</h2>
<p>At this point, it is worth saving your script. Find the single disk icons in the main menu or the menu for your script</p>
<p><img src="images/rstudio-cloud-screen-save-script.png" width="750px" /></p>
<p>Click either of these icons to save the file. The first time you do this you’ll be prompted to enter a file name — use something memorable and be sure to give it the extension <code>.R</code>. In the image below I named my script <code>biol266.R</code>.</p>
<p><img src="images/rstudio-cloud-screen-save-script-dialog.png" width="350px" /></p>
<p>Then click <strong>Save</strong>.</p>
<p>Be sure to save your work regularly during class. You can use <kbd>Ctrl</kbd> + <kbd>s</kbd> on Windows and <kbd>Cmd</kbd> + <kbd>s</kbd> on Mac to save changes you make to your script, or click on the disk icon as before.</p>
</div>
</div>
<div id="load-data" class="section level1">
<h1>Load Data</h1>
<p>The experimental data exist in <code>f19ph.xlsx</code>, an Excel workbook. The example data I’ll use here are in two of the sheets in this workbook. <em>You will need to know what number your sheets are in this file.</em></p>
<p>First we’ll read in the data for the wild type cultivar using the <code>read_excel()</code> function</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>col_types &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;text&#39;</span>,<span class="st">&#39;numeric&#39;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">9</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a>wt &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&#39;f19ph.xlsx&#39;</span>, <span class="dt">sheet =</span> <span class="dv">2</span>, <span class="dt">col_types =</span> col_types)</span></code></pre></div>
<p>To avoid reading in incorrect data, we tell <code>read_excel()</code> what types of data to expect in each column of the sheet we read in — there are three text columns, followed by nine columns of numbers.</p>
<p>If there were no errors or messages printed to the screen then the data were loaded into R. Take a look at the data by typing the name of the object (<code>wt</code>) and hitting <kbd>Return</kbd></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>wt</span></code></pre></div>
<pre><code>## # A tibble: 24 x 12
##    treatment cultivar plantid `height:0` `internodes:0` `height:7`
##    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
##  1 control   wt       1              235              4        525
##  2 control   wt       2              182              3        391
##  3 control   wt       3              253              3        452
##  4 control   wt       4              151              3        350
##  5 control   wt       5              195              3        335
##  6 control   wt       6              187              4        190
##  7 ga10      wt       1              250              4        458
##  8 ga10      wt       2              220              4        345
##  9 ga10      wt       3              180              2        300
## 10 ga10      wt       4              230              4        510
## # … with 14 more rows, and 6 more variables: `internodes:7` &lt;dbl&gt;,
## #   `height:14` &lt;dbl&gt;, `internodes:14` &lt;dbl&gt;, `height:21` &lt;dbl&gt;,
## #   `internodes:21` &lt;dbl&gt;, `freshwt:21` &lt;dbl&gt;</code></pre>
<p>Your data should look similar to the output above. Namely, the example data are in a data frame with 24 rows and 12 columns.</p>
<p>The column names contain <em>data</em>; we want to extract the variable (<code>height</code>, <code>internodes</code> etc) as well as the day of each observation from the column names. The variable name and the day of observation are separated by a colon <code>:</code> in each column name.</p>
<div id="data-formats" class="section level2">
<h2>Data formats</h2>
<p>The data are also in what we call <em>wide</em> format — where multiple observations are in a row — but to fit a statistical model we need them in <em>long</em> format — where each row corresponds to a single observation.</p>
<p><img src="images/original-dfs-tidy.png" width="1050" /></p>
</div>
<div id="pivoting" class="section level2">
<h2>Pivoting</h2>
<p>We need to convert the data into <em>long</em> format and extract the variable and day information from the column names as we do the conversion. This operation of going from <em>wide</em> to <em>long</em> (or the reverse) is more commonly known as a <em>pivot</em>.</p>
<p>The first three columns don’t contain data (actual measurements). These columns are useful meta data, but we do not need to pivot those columns, so we’ll exclude them from the pivot.</p>
<p><img src="images/tidyr-longer-wider.gif" /><!-- --></p>
<p>As we want to pivot to the <em>long</em> format we use the <code>pivot_longer()</code> function. In the code block below we pass five arguments:</p>
<ol style="list-style-type: decimal">
<li><code>wt</code> — this is the name of the object we want to pivot,</li>
<li><code>-(treatment:plantid)</code> — we don’t want to pivot those columns, so we <em>exclude</em> them by name</li>
<li><code>names_to = c('variable','day')</code> — we want to create new columns with the names <em>variable</em> and <em>day</em></li>
<li><code>names_sep = ':'</code> — the variable name and day information are in the column names separated by <code>:</code></li>
<li><code>names_transform = list(day = as.integer)</code> — we want the created <code>day</code> column to contain integer values not text</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>wt &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(wt,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                   <span class="op">-</span>(treatment<span class="op">:</span>plantid),</span>
<span id="cb10-3"><a href="#cb10-3"></a>                   <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&#39;variable&#39;</span>,<span class="st">&#39;day&#39;</span>),</span>
<span id="cb10-4"><a href="#cb10-4"></a>                   <span class="dt">names_sep =</span> <span class="st">&#39;:&#39;</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                   <span class="dt">names_transform =</span> <span class="kw">list</span>(<span class="dt">day =</span> as.integer))</span></code></pre></div>
<p>Take a look at what we have created</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>wt</span></code></pre></div>
<pre><code>## # A tibble: 216 x 6
##    treatment cultivar plantid variable     day  value
##    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;int&gt;  &lt;dbl&gt;
##  1 control   wt       1       height         0  235  
##  2 control   wt       1       internodes     0    4  
##  3 control   wt       1       height         7  525  
##  4 control   wt       1       internodes     7    5  
##  5 control   wt       1       height        14  810  
##  6 control   wt       1       internodes    14   10  
##  7 control   wt       1       height        21 1090  
##  8 control   wt       1       internodes    21   14  
##  9 control   wt       1       freshwt       21    7.2
## 10 control   wt       2       height         0  182  
## # … with 206 more rows</code></pre>
<p>Now we have some new columns in addition to the three columns we <em>did not</em> pivot</p>
<ol style="list-style-type: decimal">
<li><code>variable</code> — what was measured?</li>
<li><code>day</code> — when was it measured?</li>
<li><code>value</code> — what value did you write down for this measurement?</li>
</ol>
<p>We have one more data processing step to perform to get the required format for the analysis. We want separate columns for the different types of variable we measured (<code>height</code>, <code>internodes</code>, <code>freshwt</code>). At the moment these are all contained in the single column <code>variable</code>. To get the format we want, we need to pivot from this long format back to a wide format, which we do using the <code>pivot_wider()</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>wt &lt;-<span class="st"> </span><span class="kw">pivot_wider</span>(wt, <span class="dt">names_from =</span> variable, <span class="dt">values_from =</span> value)</span></code></pre></div>
<p>As well as the name of the object we want to pivot (<code>wt</code>), we have to tell <code>pivot_wider()</code> which column contains the information for the new column names (the <code>names_from</code> argument), and which column contains the data or values (the <code>values_from</code> argument). Remember that the <code>variable</code> column contains the names of each variable you measured and the <code>value</code> column contains the measurement values.</p>
<p>Look at the result</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>wt</span></code></pre></div>
<pre><code>## # A tibble: 96 x 7
##    treatment cultivar plantid   day height internodes freshwt
##    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1 control   wt       1           0    235          4    NA  
##  2 control   wt       1           7    525          5    NA  
##  3 control   wt       1          14    810         10    NA  
##  4 control   wt       1          21   1090         14     7.2
##  5 control   wt       2           0    182          3    NA  
##  6 control   wt       2           7    391          5    NA  
##  7 control   wt       2          14    615          9    NA  
##  8 control   wt       2          21    810         12     3.8
##  9 control   wt       3           0    253          3    NA  
## 10 control   wt       3           7    452          6    NA  
## # … with 86 more rows</code></pre>
<p>We now have columns of data for <code>height</code>, <code>internodes</code>, &amp; <code>freshwt</code>. The <code>NA</code> values in <code>freshwt</code> are indicators of <em>missing</em> <em>data</em> because you only measured the fresh weight of the plants on day 21.</p>
<p>To load in the dwarf cultivar data we repeat these steps</p>
<ol style="list-style-type: decimal">
<li>reading in the data,</li>
<li>pivoting from wide to long format and extracting the variable name and day information from the column headers</li>
<li>pivoting from long to wide format to create a column of data for each of three variables you measured</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>dwarf &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&#39;f19ph.xlsx&#39;</span>, <span class="dt">sheet =</span> <span class="dv">4</span>, <span class="dt">col_types =</span> col_types)</span>
<span id="cb16-2"><a href="#cb16-2"></a>dwarf &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(dwarf, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">names_sep =</span> <span class="st">&#39;:&#39;</span>,</span>
<span id="cb16-3"><a href="#cb16-3"></a>                      <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&#39;variable&#39;</span>,<span class="st">&#39;day&#39;</span>),</span>
<span id="cb16-4"><a href="#cb16-4"></a>                      <span class="dt">names_transform =</span> <span class="kw">list</span>(<span class="dt">day =</span> as.integer))</span>
<span id="cb16-5"><a href="#cb16-5"></a>dwarf &lt;-<span class="st"> </span><span class="kw">pivot_wider</span>(dwarf, <span class="dt">names_from =</span> variable, <span class="dt">values_from =</span> value)</span>
<span id="cb16-6"><a href="#cb16-6"></a>dwarf</span></code></pre></div>
<pre><code>## # A tibble: 96 x 7
##    treatment cultivar plantid   day height internodes freshwt
##    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1 control   dwarf    1           0     47          4      NA
##  2 control   dwarf    1           7     92          7      NA
##  3 control   dwarf    1          14     97          7      NA
##  4 control   dwarf    1          21    110          9       2
##  5 control   dwarf    2           0     35          3      NA
##  6 control   dwarf    2           7     64          5      NA
##  7 control   dwarf    2          14     90          5      NA
##  8 control   dwarf    2          21     NA         NA      NA
##  9 control   dwarf    3           0     45          4      NA
## 10 control   dwarf    3           7     67          5      NA
## # … with 86 more rows</code></pre>
<p>Now that we have the data as we’d like it, we need to stick the two objects together, which we do with <code>bind_rows()</code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>plant &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(wt, dwarf)</span></code></pre></div>
<p>So that we can draw growth lines for each individual plant, we need a unique identifier for each plant. We can achieve that by concatenating or pasting together the <code>cultivar</code>, <code>treatment</code> and <code>plantid</code> information, separated by underscores <code>_</code></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>plant &lt;-<span class="st"> </span><span class="kw">mutate</span>(plant, <span class="dt">id =</span> <span class="kw">paste</span>(cultivar, treatment, plantid, <span class="dt">sep =</span> <span class="st">&#39;_&#39;</span>))</span></code></pre></div>
<p>One final data processing step involves getting the coding for the <code>treatment</code> variable right so that the <em>control</em> treatment is the reference level against which the other treatments will be compared. Changing the reference level of a factor (a categorical variable) is known as <em>releveling</em>. We change the reference levels using</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>plant &lt;-<span class="st"> </span><span class="kw">mutate</span>(plant, <span class="dt">treatment =</span> <span class="kw">fct_relevel</span>(treatment, <span class="st">&#39;control&#39;</span>))</span></code></pre></div>
<p>OK, that’s a lot of data processing. Let’s look at the data.</p>
</div>
</div>
<div id="fresh-weight-on-day-21" class="section level1">
<h1>Fresh weight on day 21</h1>
<p>We’ll start by taking a look at the fresh weight of the plants on day 21. One way to look at these data is as box plots of the weights for each combination of <code>cultivar</code> and <code>treatment</code>. To plot the data we’ll use the powerful <strong>ggplot2</strong> package and the function <code>ggplot()</code>. To draw our plot we need to tell <code>ggplot()</code> the following information</p>
<ol style="list-style-type: decimal">
<li>the name of the object that contains the data we want to plot; in our case this is <code>plant</code></li>
<li>we need to <em>map</em> variables in <code>plant</code> to the axes and other visual attributes, here <code>colour</code>
<ul>
<li>we want the <code>treatment</code> data on the <em>x</em> axis,</li>
<li>we want the plant fresh weights (<code>freshwt</code>) on the <em>y</em> axis,</li>
<li>we want to distinguish between the wild type and dwarf cultivar using colour</li>
</ul></li>
<li>we need to add a layer to the plot that actually draws the box plots using <code>geom_boxplot()</code>, and</li>
<li>we need to add some proper axis labels, using <code>labs()</code></li>
</ol>
<p>Notice how we add layers and features to the plot using the <code>+</code> operator at the end of statement.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> plant, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> treatment, <span class="dt">y =</span> freshwt, <span class="dt">colour =</span> cultivar)) <span class="op">+</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&#39;Fresh weight (g)&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;Treatment&#39;</span>, <span class="dt">colour =</span> <span class="st">&quot;Cultivar&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 149 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="lab-analysis_files/figure-html/fresh-wt-boxplot-1.png" width="672" /></p>
<p>You can ignore the <em>warning</em> about removing some rows with missing data. If you get other warnings or your plot doesn’t look similar to the one above, double check your code for typos and if you’re still stuck ask for help.</p>
<p>Look at the plot you just drew and think about what the data might be telling you about</p>
<ul>
<li>how the various treatments might have affected the fresh weight (as a surrogate for plant biomass or size),</li>
<li>whether all the treatments affected the plants in the same way, and</li>
<li>whether the treatments affected the two cultivars in similar or different ways?</li>
</ul>
<div id="anova" class="section level2">
<h2>ANOVA</h2>
<p>The way we plotted the data gives us a guide as to how to approach answering the questions you were just asked to think about. We have a <em>response</em> variable — the fresh weight of each plant on day 21, <code>freshwt</code> — also known as the <em>dependent</em> variable. We also have two <em>independent</em> variables that define the experimental design:</p>
<ol style="list-style-type: decimal">
<li>the various control and treatments applied to the plants, <code>treatment</code>, and</li>
<li>the type of cultivar that each plant belongs to.</li>
</ol>
<p>The model we want to fit is a special case of a linear model that is commonly known as an <em>analysis of variance</em> or <em>ANOVA</em>.</p>
<div id="potential-results" class="section level3">
<h3>Potential results</h3>
<p>It is always worth thinking about the kinds of result we might expect from an statistical analysis. When considering the <em>fresh weight</em> data we could think of <strong>four</strong> potential types of result:</p>
<p><img src="lab-analysis_files/figure-html/anova-hypo-examples-1.png" width="1440" /></p>
<p>We will fit an ANOVA that allows for the most complex result — different treatment effects in the two cultivars — but we will look at the model output to see if the results are more consistent with one of the other options.</p>
<p>An ANOVA is a model where the independent variables are <strong>categorical</strong> variables. <strong>Categorical</strong> variables are ones where each value is one option from a set of possible values. For example we might have a variable <code>car_colour</code> where each value is one from the set <code>red</code>, <code>blue</code>, <code>white</code>, or <code>black</code>. Another example might be a variable <code>river_flow</code>, taking values <code>none</code>, <code>low</code>, <code>medium</code>, and <code>high</code>. There is no implied ordering in car colour variable so we call this a <strong>nominal</strong> categorical variable. Sometimes you might here people call this kind of variable <em>qualitative</em>. Where the variable has an implied ordering, like the <code>river_flow</code> example, we call those variables <strong>ordinal</strong> categorical variables. These may also be referred to as <em>semi-quantitative</em>. In R, categorical variables are known as <em>factors</em>.</p>
<p>Using R we can fit the ANOVA with the <code>lm()</code> function. We specify the model structure using a symbolic formula. The formula we’ll use is</p>
<pre><code>freshwt ~ treatment * cultivar</code></pre>
<p>The response (dependent) variable is on the left hand side of the <code>~</code> (the tilde symbol). This is the variable we wish to explain. The right hand side of the formula contains the independent variables in the model. We want to allow for <em>different</em> effects of the various treatments among the two cultivars — gibberellic acid might affect the dwarf cultivar more than the wild type, for example. To achieve this in addition to the <em>main effects</em> of <code>treatment</code> and <code>cultivar</code> we need to have the effects of the treatments <em>interact</em> with the effects of the cultivar. In R we indicate that we want main effects plus their interaction using the <code>*</code> symbol. The only other thing we need to tell R is where to find the variables named in the formula describing the model we want to fit — we do this using the <code>data</code> argument.</p>
<p>Let’s fit the ANOVA</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>fw1 &lt;-<span class="st"> </span><span class="kw">lm</span>(freshwt <span class="op">~</span><span class="st"> </span>cultivar <span class="op">*</span><span class="st"> </span>treatment, <span class="dt">data =</span> plant)</span></code></pre></div>
<p>We have stored the result of the ANOVA fit in an object named <code>fw1</code>. We can summarize the model fit in a couple of ways; first we look at the model summary</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">summary</span>(fw1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = freshwt ~ cultivar * treatment, data = plant)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7667 -0.6800 -0.0667  0.4875  3.4000 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)               1.400000   0.681348   2.055  0.04743 * 
## cultivarwt                2.400000   0.879616   2.728  0.00988 **
## treatmentb9              -0.033333   0.879616  -0.038  0.96999   
## treatmentga10             0.560000   0.914124   0.613  0.54410   
## treatmentga75             0.325000   0.963571   0.337  0.73791   
## cultivarwt:treatmentb9    0.500000   1.180129   0.424  0.67439   
## cultivarwt:treatmentga10  0.006667   1.206069   0.006  0.99562   
## cultivarwt:treatmentga75  1.441667   1.243965   1.159  0.25433   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.363 on 35 degrees of freedom
##   (149 observations deleted due to missingness)
## Multiple R-squared:  0.6067, Adjusted R-squared:  0.528 
## F-statistic: 7.713 on 7 and 35 DF,  p-value: 1.236e-05</code></pre>
<p>The omnibus (overall) test of the model is summarized in the <em>F</em> statistic and its <em>p</em> value. Find this information in the output. In the example shown here, the <em>F</em> statistic is 7.71 on 7 and 35 degrees of freedom, with a <em>p</em> value of &lt; 0.0001. This <em>p</em> value indicates that it would quite unlikely — less than 1 in 10,000 — that we would have observed these differences between cultivars and treatments if there were <em>no differences</em> between cultivars and treatments.</p>
<p>This test gives us some gross information about the combined effects of the treatments on the cultivars, but it doesn’t provide much detail on which treatments differ and whether there are different treatment effects in the two cultivars. To answer these questions we’ll need to do some further processing of the model to compute what are known as <em>estimated marginal means</em>.</p>
</div>
</div>
<div id="treatments-vs-controls" class="section level2">
<h2>Treatments vs controls</h2>
<p>The first test we might do is to compare each treatment with the control plants. This involves calculating from the model the <em>difference</em> between each level of the treatment and the control. These estimated differences are uncertain so we can express this uncertainty using a confidence interval. Additionally we can do a statistical test of the null hypothesis that the difference is equal to <strong>0</strong> — which is the same as testing the null hypothesis of equal effects. Because the treatment effect is <em>nested</em> within the cultivar effect, we will estimate the difference separately for each cultivar.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>fw1mm &lt;-<span class="st"> </span><span class="kw">emmeans</span>(fw1, trt.vs.ctrl <span class="op">~</span><span class="st"> </span>treatment <span class="op">|</span><span class="st"> </span>cultivar)</span></code></pre></div>
<p>We saved the result of the <code>emmeans()</code> in an object named <code>fw1mm</code>. To show the estimated marginal means we type the name of the object and hit <kbd>Return</kbd></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>fw1mm</span></code></pre></div>
<pre><code>## $emmeans
## cultivar = dwarf:
##  treatment emmean    SE df lower.CL upper.CL
##  control     1.40 0.681 35   0.0168     2.78
##  b9          1.37 0.556 35   0.2373     2.50
##  ga10        1.96 0.609 35   0.7228     3.20
##  ga75        1.73 0.681 35   0.3418     3.11
## 
## cultivar = wt:
##  treatment emmean    SE df lower.CL upper.CL
##  control     3.80 0.556 35   2.6706     4.93
##  b9          4.27 0.556 35   3.1373     5.40
##  ga10        4.37 0.556 35   3.2373     5.50
##  ga75        5.57 0.556 35   4.4373     6.70
## 
## Confidence level used: 0.95 
## 
## $contrasts
## cultivar = dwarf:
##  contrast       estimate    SE df t.ratio p.value
##  b9 - control    -0.0333 0.880 35 -0.038  0.9995 
##  ga10 - control   0.5600 0.914 35  0.613  0.8446 
##  ga75 - control   0.3250 0.964 35  0.337  0.9535 
## 
## cultivar = wt:
##  contrast       estimate    SE df t.ratio p.value
##  b9 - control     0.4667 0.787 35  0.593  0.8541 
##  ga10 - control   0.5667 0.787 35  0.720  0.7876 
##  ga75 - control   1.7667 0.787 35  2.246  0.0818 
## 
## P value adjustment: dunnettx method for 3 tests</code></pre>
<p>The output is in two parts:</p>
<ol style="list-style-type: decimal">
<li><code>$emmeans</code> shows the estimated marginal means of <code>freshwt</code> for each level of <code>treatment</code> in each of the two cultivars, and</li>
<li><code>$contrasts</code> shows the comparison between each treatment level and the control, separately for each cultivar.</li>
</ol>
<p>In the first part (<code>$emmeans</code>) the column labelled <code>emmean</code> is the estimated marginal mean for each level of the treatment, whilst <code>SE</code> is the standard error — a measure of uncertainty in the estimated value — of the <code>emmean</code>. The <code>df</code> column indicates the degrees of freedom for each of the groupings, and the columns labelled <code>lower.CL</code> and <code>upper.CL</code> contain the lower and upper limits of the confidence interval, for the stated confidence level (here is it the 95% or 0.95 level). The confidence interval is calculated using the <code>SE</code> data, with the interval representing the range of uncertainty in the estimated marginal means.</p>
<p>How do you interpret this? Well, the <code>emmean</code> columns are the estimated <em>average</em> fresh weight of a plant from that particular cultivar under each of the treatments. In the example we can see that treatment with the largest fresh weight for the dwarf cultivar is the <code>ga10</code> treatment, whilst it is the <code>ga75</code> treatment level in the wild type. In the dwarf cultivar we see that the estimated average fresh weight of a plant treated with <code>b9</code> is slightly <em>lower</em> than the average for the control plants.</p>
<p>The kind of comparisons we just made are relatively informal. The <code>$contrasts</code> part of the output shows results of more formal comparisons with actual statistical tests comparing each treatment with the control. Note that the <em>p</em> values have been adjusted to account for there being <em>three</em> tests in each cultivar — this means the results shown account for the uncertainty that arises due to doing multiple tests.</p>
<p>Look back at the <em>p</em> values in the output above. <strong>Are any of the comparisons between treatment and control significantly different from 0 (assume a 95% or 0.95 level of confidence)?</strong></p>
<p>We can plot the estimated marginal means using the <code>plot()</code> method, which might make it easier to see what the table of results means:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">plot</span>(fw1mm, <span class="dt">comparisons =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="lab-analysis_files/figure-html/plot-trt-ctrl-emms-1.png" width="672" /></p>
<p>The plot shows the values from the <code>emmean</code> column as the black points, while the confidence interval is represented by the pale blue bars. The red arrows are <em>comparison arrows</em>, which were added using <code>comparisons = TRUE</code>. Take any pair of points; whether the arrows overlap is an <em>approximate</em> indication of whether, at the 95% or 0.95 level, the pair of points are <em>significantly different from one another</em>. If the arrows <em>do not</em> overlap for a pair of points we can conclude that the mean fresh weight of the plants is different between the pair of treatments.</p>
</div>
<div id="pairwise-comparisons" class="section level2">
<h2>Pairwise comparisons</h2>
<p>We can do the statistical tests implied by the <em>comparison arrows</em> using the <code>emmeans()</code> function but asking for <em>pairwise comparisons</em> instead of <em>treatment vs control</em> comparisons. This is done using the <code>pairwise</code> option.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">emmeans</span>(fw1, pairwise <span class="op">~</span><span class="st"> </span>treatment <span class="op">|</span><span class="st"> </span>cultivar)</span></code></pre></div>
<pre><code>## $emmeans
## cultivar = dwarf:
##  treatment emmean    SE df lower.CL upper.CL
##  control     1.40 0.681 35   0.0168     2.78
##  b9          1.37 0.556 35   0.2373     2.50
##  ga10        1.96 0.609 35   0.7228     3.20
##  ga75        1.73 0.681 35   0.3418     3.11
## 
## cultivar = wt:
##  treatment emmean    SE df lower.CL upper.CL
##  control     3.80 0.556 35   2.6706     4.93
##  b9          4.27 0.556 35   3.1373     5.40
##  ga10        4.37 0.556 35   3.2373     5.50
##  ga75        5.57 0.556 35   4.4373     6.70
## 
## Confidence level used: 0.95 
## 
## $contrasts
## cultivar = dwarf:
##  contrast       estimate    SE df t.ratio p.value
##  control - b9     0.0333 0.880 35  0.038  1.0000 
##  control - ga10  -0.5600 0.914 35 -0.613  0.9274 
##  control - ga75  -0.3250 0.964 35 -0.337  0.9866 
##  b9 - ga10       -0.5933 0.825 35 -0.719  0.8888 
##  b9 - ga75       -0.3583 0.880 35 -0.407  0.9768 
##  ga10 - ga75      0.2350 0.914 35  0.257  0.9939 
## 
## cultivar = wt:
##  contrast       estimate    SE df t.ratio p.value
##  control - b9    -0.4667 0.787 35 -0.593  0.9335 
##  control - ga10  -0.5667 0.787 35 -0.720  0.8884 
##  control - ga75  -1.7667 0.787 35 -2.246  0.1310 
##  b9 - ga10       -0.1000 0.787 35 -0.127  0.9993 
##  b9 - ga75       -1.3000 0.787 35 -1.652  0.3636 
##  ga10 - ga75     -1.2000 0.787 35 -1.525  0.4337 
## 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
<p>Again we get the two types of output and the <code>$emmeans</code> part is identical to the one we saw before (we’re estimating the same marginal mean fresh weight for each treatment). What is different is the <code>$contrasts</code> section, which now contains comparisons between all pairs of treatments for each cultivar. Again the <em>p</em> values have been adjusted to account for the multiple tests that were performed.</p>
<p><strong>Are any of the pairwise comparisons significantly different?</strong></p>
<p>We can compare differences between cultivars for each level of the treatment using a similar approach:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">emmeans</span>(fw1, pairwise <span class="op">~</span><span class="st"> </span>cultivar <span class="op">|</span><span class="st"> </span>treatment)</span></code></pre></div>
<pre><code>## $emmeans
## treatment = control:
##  cultivar emmean    SE df lower.CL upper.CL
##  dwarf      1.40 0.681 35   0.0168     2.78
##  wt         3.80 0.556 35   2.6706     4.93
## 
## treatment = b9:
##  cultivar emmean    SE df lower.CL upper.CL
##  dwarf      1.37 0.556 35   0.2373     2.50
##  wt         4.27 0.556 35   3.1373     5.40
## 
## treatment = ga10:
##  cultivar emmean    SE df lower.CL upper.CL
##  dwarf      1.96 0.609 35   0.7228     3.20
##  wt         4.37 0.556 35   3.2373     5.50
## 
## treatment = ga75:
##  cultivar emmean    SE df lower.CL upper.CL
##  dwarf      1.73 0.681 35   0.3418     3.11
##  wt         5.57 0.556 35   4.4373     6.70
## 
## Confidence level used: 0.95 
## 
## $contrasts
## treatment = control:
##  contrast   estimate    SE df t.ratio p.value
##  dwarf - wt    -2.40 0.880 35 -2.728  0.0099 
## 
## treatment = b9:
##  contrast   estimate    SE df t.ratio p.value
##  dwarf - wt    -2.90 0.787 35 -3.686  0.0008 
## 
## treatment = ga10:
##  contrast   estimate    SE df t.ratio p.value
##  dwarf - wt    -2.41 0.825 35 -2.917  0.0061 
## 
## treatment = ga75:
##  contrast   estimate    SE df t.ratio p.value
##  dwarf - wt    -3.84 0.880 35 -4.367  0.0001</code></pre>
<p>This time we get a different <code>$emmeans</code> section as we are now estimating the marginal mean fresh weight for each cultivar, for each level of the treatment. The <code>$contrasts</code> section now contains a single comparison for each treatment level as we only have a single pair of cultivars.</p>
<p><strong>Are any of these pairwise comparisons significantly different?</strong> <strong>What does this suggest about the effects of the treatment and the cultivar on the fresh weight of the plants?</strong></p>
</div>
</div>
<div id="plant-height" class="section level1">
<h1>Plant height</h1>
<p>We can plot the plant height data over time using the following code</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">ggplot</span>(plant, <span class="kw">aes</span>(<span class="dt">x =</span> day, <span class="dt">y =</span> height, <span class="dt">group =</span> id, <span class="dt">colour =</span> treatment)) <span class="op">+</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>cultivar) <span class="op">+</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&#39;Height (mm)&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;Day&#39;</span>, <span class="dt">colour =</span> <span class="st">&#39;Treatment&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<p><img src="lab-analysis_files/figure-html/plot-height-data-1.png" width="672" /></p>
<p>As before, we specify the data and the mapping of variables to axes and the colour channel. One difference here is that as we want to group the data for each plant and draw lines through the observations to better show how the height of each plant changed over time. We indicate this grouping via the <code>group</code> aesthetic, which we set to the <code>id</code> variable we created earlier.</p>
<p>This plot has two layers:</p>
<ol style="list-style-type: decimal">
<li>a point layer (<code>geom_point()</code>), and</li>
<li>a line layer (<code>geom_line()</code>)</li>
</ol>
<p>We also draw the data for the two cultivars in it’s own panel, which <em>ggplot</em> calls <em>faceting</em>. The final line adds some nice labels to the plot.</p>
<div id="ancova" class="section level2">
<h2>ANCOVA</h2>
<p>The model we are fitting is sometimes called an <em>analysis of covariance</em> or ANCOVA, which is another special case of a linear model that can also be fitted using the <code>lm()</code> function. In an ANCOVA, we <em>control</em> for the effects of a continuous variable whilst interest is on a categorical treatment effect.</p>
<div id="potential-results-1" class="section level3">
<h3>Potential results</h3>
<p>As before, it is helpful to think about the kinds of result we might expect from the statistical analysis. When considering the <em>plan height</em> data we could think of <strong>five</strong> basic types of result:</p>
<p><img src="lab-analysis_files/figure-html/ancova-hypo-examples-1.png" width="1440" /></p>
<p>In addition, <em>some</em> or <em>all</em> of the above effects could be either</p>
<ul>
<li>the same in both the wild-type and dwarf mutant cultivars, or</li>
<li>they could differ between the wild-type and the dwarf mutant cultivars.</li>
</ul>
<p>We specify the model structure using a symbolic formula. The formula we’ll use is</p>
<pre><code>height ~ day * treatment * cultivar</code></pre>
<p>The response (dependent) variable is on the left hand side of the <code>~</code> (the tilde symbol). This is the variable we wish to explain. The right hand side of the formula contains the independent variables in the model. Here, the independent variables represent the experimental setup.</p>
<p>Given our experimental design, the most complex model we can fit is one that allows for different growth rates (effects of <code>day</code>) for each treatment level for each cultivar. In other words we want to have a different growth rate for each combination of treatment and cultivar.</p>
<p>Such a model implies a three-way interaction between <code>day</code>, <code>treatment</code>, and <code>cultivar</code>. We indicate interactions in the formula using the <code>*</code> symbol.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>h1 &lt;-<span class="st"> </span><span class="kw">lm</span>(height <span class="op">~</span><span class="st"> </span>day <span class="op">*</span><span class="st"> </span>treatment <span class="op">*</span><span class="st"> </span>cultivar, <span class="dt">data =</span> plant)</span></code></pre></div>
<p>We can summarize the model to look for some key diagnostics of the fit</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">summary</span>(h1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = height ~ day * treatment * cultivar, data = plant)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -386.45  -17.86   -1.87   21.72  353.55 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   45.8717    35.4390   1.294  0.19732    
## day                            2.6802     2.8989   0.925  0.35652    
## treatmentb9                   12.1450    49.3490   0.246  0.80590    
## treatmentga10                 11.5210    49.4993   0.233  0.81624    
## treatmentga75                 -4.0763    49.6578  -0.082  0.93467    
## cultivarwt                   151.9283    49.3490   3.079  0.00243 ** 
## day:treatmentb9               -0.8564     3.9090  -0.219  0.82685    
## day:treatmentga10              1.7500     3.9945   0.438  0.66188    
## day:treatmentga75              7.8468     4.0948   1.916  0.05704 .  
## day:cultivarwt                22.9698     3.9090   5.876 2.22e-08 ***
## treatmentb9:cultivarwt        37.9884    69.2396   0.549  0.58398    
## treatmentga10:cultivarwt      19.6790    69.3468   0.284  0.77693    
## treatmentga75:cultivarwt      26.6763    69.4601   0.384  0.70143    
## day:treatmentb9:cultivarwt    -8.7912     5.3884  -1.632  0.10467    
## day:treatmentga10:cultivarwt   2.9810     5.4507   0.547  0.58518    
## day:treatmentga75:cultivarwt   8.5366     5.5246   1.545  0.12420    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 100.5 on 167 degrees of freedom
##   (9 observations deleted due to missingness)
## Multiple R-squared:  0.8967, Adjusted R-squared:  0.8874 
## F-statistic: 96.61 on 15 and 167 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Most of this isn’t very helpful in this state, except the omnibus <em>F</em> test which indicates if the total variance explained by all the model terms is significantly large relative to the unexplained variance.</p>
</div>
</div>
<div id="treatments-vs-controls-1" class="section level2">
<h2>Treatments vs controls</h2>
<p>To get more interpretable output we will again use estimate marginal means, but with one slight difference; this time we are interested in the linear effect of <code>day</code>, a continuous variable, as well as the treatment and cultivar effects. The <code>day</code> effect will be represented by straight lines (regression lines), the slopes of which reflect the average growth rate of plants in the combinations of treatments and cultivars. These lines are often called <em>trends</em> hence we use the <code>emtrends()</code> function to estimate the marginal trends instead of the marginal means.</p>
<p>As before we will start by comparing the treated plants with the control plants. This time however we need to indicate the <em>trend</em> variable via argument <code>var</code>. In our case the trend variable is <code>day</code> (which is indicated by the name in quotes)</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>h1mm &lt;-<span class="st"> </span><span class="kw">emtrends</span>(h1, trt.vs.ctrl <span class="op">~</span><span class="st"> </span>treatment <span class="op">|</span><span class="st"> </span>cultivar, <span class="dt">var =</span> <span class="st">&quot;day&quot;</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>h1mm</span></code></pre></div>
<pre><code>## $emtrends
## cultivar = dwarf:
##  treatment day.trend   SE  df lower.CL upper.CL
##  control        2.68 2.90 167   -3.043     8.40
##  b9             1.82 2.62 167   -3.354     7.00
##  ga10           4.43 2.75 167   -0.995     9.86
##  ga75          10.53 2.89 167    4.817    16.24
## 
## cultivar = wt:
##  treatment day.trend   SE  df lower.CL upper.CL
##  control       25.65 2.62 167   20.473    30.83
##  b9            16.00 2.62 167   10.825    21.18
##  ga10          30.38 2.62 167   25.204    35.56
##  ga75          42.03 2.62 167   36.856    47.21
## 
## Confidence level used: 0.95 
## 
## $contrasts
## cultivar = dwarf:
##  contrast       estimate   SE  df t.ratio p.value
##  b9 - control     -0.856 3.91 167 -0.219  0.9809 
##  ga10 - control    1.750 3.99 167  0.438  0.9202 
##  ga75 - control    7.847 4.09 167  1.916  0.1453 
## 
## cultivar = wt:
##  contrast       estimate   SE  df t.ratio p.value
##  b9 - control     -9.648 3.71 167 -2.601  0.0281 
##  ga10 - control    4.731 3.71 167  1.276  0.4391 
##  ga75 - control   16.383 3.71 167  4.418  0.0001 
## 
## P value adjustment: dunnettx method for 3 tests</code></pre>
<p>You should be familiar with this output now. The <code>$emtrends</code> section contains similar outputs to the <code>$emmeans</code> sections we looked at earlier when analyzing the fresh weight of the plants. The main difference is in the interpretation of the numbers in the <code>day.trend</code> column, which replaces the <code>emmean</code> from before. The <code>day.trend</code> column contains estimates of the slope of the regression line for the <code>day</code> variable.</p>
<p>The numbers in the column are the estimated <em>change in the height</em> of the plant for a single day of growth:</p>
<ul>
<li>If the <code>day.trend</code> number is positive it means the plants in a treatment group increased in height over the experiment, and</li>
<li>if the <code>day.trend</code> number is negative it means the plants in a treatment group decreased in height over the experiment.</li>
</ul>
<p>The <code>$contrasts</code> section contains the same kind of comparisons of a treatments vs controls. Remember here that the <code>estimate</code> column contains the estimated difference in the slopes (growth rates) of the stated treatment and the control group. Hence the null hypothesis being tested is that the <em>difference in slopes is equal to zero</em>.</p>
<ul>
<li>A negative value in the <code>estimate</code> column means the average change in height in the stated treatment was lower than in the control group. In other words, the plants in that treatment group grew <em>more slowly</em> on average than the plants in the control group, and</li>
<li>A positive value in the <code>estimate</code> column means the plants in the that treatment group grew, on average, at a faster rate than plants in the control group.</li>
</ul>
<p>As before, we can plot these estimated marginal trends using the <code>plot()</code> method:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">plot</span>(h1mm, <span class="dt">comparisons =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="lab-analysis_files/figure-html/plot-treatment-v-control-by-cultivar-1.png" width="672" /></p>
<p>This plot is similar to one we created earlier when we looked at the fresh weight of the plants:</p>
<ul>
<li>the black points are the estimated growth rates (regression slopes) for each treatment group,</li>
<li>the 95% confidence interval around the estimated growth rate is shown by the pale blue bar, and</li>
<li>the red arrows are approximate pairwise comparison regions — if arrows for a pair of treatments overlap one another we fail to reject the null hypothesis of equal growth rates for plants in the two treatments.</li>
</ul>
<p>The main difference in this plot is that we no longer show the estimated marginal mean on the <em>x</em> axis. Instead the slope of the regression line (the growth rate) is plotted on the <em>x</em> axis. Remember how we interpret these numbers: the values are the estimated <em>change</em>, on average, in the height of a plant in single day of growth.</p>
<p>All this talk of estimated trends or slopes may be a little opaque, but we can plot the estimated regression lines to visualize the average growth rates of plants in each of the treatment groups using the <code>emmip()</code> function:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">emmip</span>(h1, treatment <span class="op">~</span><span class="st"> </span>day <span class="op">|</span><span class="st"> </span>cultivar, <span class="dt">cov.reduce =</span> <span class="ot">FALSE</span>, <span class="dt">CIs =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="lab-analysis_files/figure-html/height-plot-estimated-slopes-1.png" width="672" /></p>
<p>Here the formula means you want to show the <code>treatment</code> effects against <code>day</code> separately for each cultivar. The <code>cov.reduce = FALSE</code> part means that we want to plot for all values of <code>day</code> so that we get the full regression lines. Confidence intervals are added with <code>CIs = TRUE</code> — if you want to turn them off use <code>CIs = FALSE</code>.</p>
</div>
<div id="pairwise-comparisons-1" class="section level2">
<h2>Pairwise comparisons</h2>
<p>If you want formal comparisons of the growth rates for all pairs of treatments, we can also do all pairwise comparisons using the <code>emtrends()</code> function by using the <code>pairwise</code> option instead of <code>trt-vs-ctrl</code>. Firstly, we’ll compare the growth rates for all pairs of treatment groups, separately for each cultivar</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">emtrends</span>(h1, pairwise <span class="op">~</span><span class="st"> </span>treatment <span class="op">|</span><span class="st"> </span>cultivar, <span class="dt">var =</span> <span class="st">&quot;day&quot;</span>)<span class="op">$</span>contrasts</span></code></pre></div>
<pre><code>## cultivar = dwarf:
##  contrast       estimate   SE  df t.ratio p.value
##  control - b9      0.856 3.91 167  0.219  0.9963 
##  control - ga10   -1.750 3.99 167 -0.438  0.9718 
##  control - ga75   -7.847 4.09 167 -1.916  0.2252 
##  b9 - ga10        -2.606 3.80 167 -0.686  0.9023 
##  b9 - ga75        -8.703 3.90 167 -2.229  0.1196 
##  ga10 - ga75      -6.097 3.99 167 -1.528  0.4230 
## 
## cultivar = wt:
##  contrast       estimate   SE  df t.ratio p.value
##  control - b9      9.648 3.71 167  2.601  0.0492 
##  control - ga10   -4.731 3.71 167 -1.276  0.5797 
##  control - ga75  -16.383 3.71 167 -4.418  0.0001 
##  b9 - ga10       -14.379 3.71 167 -3.877  0.0009 
##  b9 - ga75       -26.031 3.71 167 -7.019  &lt;.0001 
##  ga10 - ga75     -11.652 3.71 167 -3.142  0.0106 
## 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
<p>Here, to save space we only show the pairwise comparisons (the <code>$contrasts</code> section) as the <code>$emtrends</code> section repeats the one from earlier in this analysis.</p>
<p>If we’re interested in comparing the growth rates of the two cultivars, we need to do this separately for each treatment. We can do these comparisons with <code>emtrends()</code> by reverting the order in which we specify <code>treatment</code> and <code>cultivar</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">emtrends</span>(h1, pairwise <span class="op">~</span><span class="st"> </span>cultivar <span class="op">|</span><span class="st"> </span>treatment, <span class="dt">var =</span> <span class="st">&quot;day&quot;</span>)</span></code></pre></div>
<pre><code>## $emtrends
## treatment = control:
##  cultivar day.trend   SE  df lower.CL upper.CL
##  dwarf         2.68 2.90 167   -3.043     8.40
##  wt           25.65 2.62 167   20.473    30.83
## 
## treatment = b9:
##  cultivar day.trend   SE  df lower.CL upper.CL
##  dwarf         1.82 2.62 167   -3.354     7.00
##  wt           16.00 2.62 167   10.825    21.18
## 
## treatment = ga10:
##  cultivar day.trend   SE  df lower.CL upper.CL
##  dwarf         4.43 2.75 167   -0.995     9.86
##  wt           30.38 2.62 167   25.204    35.56
## 
## treatment = ga75:
##  cultivar day.trend   SE  df lower.CL upper.CL
##  dwarf        10.53 2.89 167    4.817    16.24
##  wt           42.03 2.62 167   36.856    47.21
## 
## Confidence level used: 0.95 
## 
## $contrasts
## treatment = control:
##  contrast   estimate   SE  df t.ratio p.value
##  dwarf - wt    -23.0 3.91 167 -5.876  &lt;.0001 
## 
## treatment = b9:
##  contrast   estimate   SE  df t.ratio p.value
##  dwarf - wt    -14.2 3.71 167 -3.823  0.0002 
## 
## treatment = ga10:
##  contrast   estimate   SE  df t.ratio p.value
##  dwarf - wt    -26.0 3.80 167 -6.832  &lt;.0001 
## 
## treatment = ga75:
##  contrast   estimate   SE  df t.ratio p.value
##  dwarf - wt    -31.5 3.90 167 -8.070  &lt;.0001</code></pre>
<p>This time we show the full output as the <code>$emtrends</code> section now contains the estimated daily growth rates (the daily change in plant height) for each cultivar in each of the treatment groups.</p>
<p>The <code>$contrasts</code> section contains compares the daily change in height of the two cultivars for each treatment group. Remember there is only a single pairwise comparison for each treatment group as we only have two cultivars to compare.</p>
<p>We can visualize the last set of comparisons using the <code>emmip()</code> function as we did previously, but now we use a different arrangement of the variables in the formula</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">emmip</span>(h1, cultivar <span class="op">~</span><span class="st"> </span>day <span class="op">|</span><span class="st"> </span>treatment, <span class="dt">cov.reduce =</span> <span class="ot">FALSE</span>, <span class="dt">CIs =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="lab-analysis_files/figure-html/plot-emtrends-pairwise-comparisons-of-cultivars-1.png" width="672" /></p>
<p><strong>Are any of these pairwise comparisons statistically significant?</strong> <strong>What does this suggest about the effects of the treatment and the cultivar on the growth rates of the plants?</strong></p>
</div>
</div>
<div id="number-of-internodes" class="section level1">
<h1>Number of internodes</h1>
<p>The number of internodes data is similar to the plant height data; the number of internodes was recorded every 7 days during the period of the experiment. Therefore, an ANCOVA is an appropriate way to analyse the internode data.</p>
<p>To analyse the inernode data, you can follow the instructions given for plant height, but use the <code>internodes</code> variable in place of <code>height</code>.</p>
<p><strong>You are required to include an analysis of the number of internodes data in your assignment for the lab.</strong></p>
</div>
<div id="exporting-images-files" class="section level1">
<h1>Exporting images &amp; files</h1>
<p>To save a plot to a file, click on the <strong>Plots</strong> tab in the lower right window, and use the arrow icons to page through the plots to the one you want. Then click the <strong>Export</strong></p>
<p><img src="images/rstudio-cloud-screen-export-button.png" width="750px" /></p>
<p>From the menu that appears choose <strong>Save as Image…</strong></p>
<p><img src="images/rstudio-cloud-screen-export-image.png" width="750px" /></p>
<p>This brings up the <strong>Save Plot as Image</strong> dialogue box. Make the following changes:</p>
<ol style="list-style-type: decimal">
<li>In the <em>Image format</em> box, select <strong>PNG</strong></li>
<li>In the <em>File name</em> box enter the file name you want for the image, include the <code>.png</code> extension</li>
<li>Change the height and width to suit
<ul>
<li>You can set the height and width in pixel in the boxes to the top right of the dialogue box. If you change these you need to click the <em>Update Preview</em> button to redraw the plot</li>
<li>Alternatively, you can use the hotspot to the bottom right corner of the plot to drag to resize. Click the <em>Update Preview</em> button to redraw the plot to the desired size</li>
</ul></li>
</ol>
<p><img src="images/rstudio-cloud-screen-export-image-dialog.png" width="750px" /></p>
<p>When you have made the required changes, click <strong>Save</strong>.</p>
<p>To export saved images or your script to your local machine, select the <strong>Files</strong> tab in the lower right window</p>
<p><img src="images/rstudio-cloud-screen-export-files.png" width="750px" /></p>
<p>Check the boxes next to the files you wish to export (download) as shown above, and then click the <strong>More</strong> button in the menu and select the <strong>Export…</strong> option.</p>
<p><img src="images/rstudio-cloud-screen-export-files-dialog.png" width="300px" /></p>
<p>Enter a filename — if you are exporting more than one file, <em>RStudio</em> will compress all the files into a single ZIP archive — if needed, but the provided name should be OK. Then click <strong>Download</strong> to download the file or the ZIP archive.</p>
</div>
<div id="logging-off" class="section level1">
<h1>Logging Off</h1>
<p>Your work will be saved in your <strong>rstudio.cloud</strong> workspace for some time after the lab. You will be able to resume from where you left off if you log in to your workspace at a late time. To be sure that the latest state of your work is saved, it would be best to log out of <strong>rstudio.cloud</strong> at the end of class today.</p>
<p>Locate your user name in the top right of the screen</p>
<p><img src="images/rstudio-cloud-screen-logout-1.png" width="250px" /></p>
<p>Click your user name to open the menu</p>
<p><img src="images/rstudio-cloud-screen-logout-2.png" width="500px" /></p>
<p>Click “Log out” to securely log out of <strong>rstudio.cloud</strong>.</p>
</div>
<div id="final-thoughts" class="section level1">
<h1>Final thoughts</h1>
<p>The statistical models shown here are intended to give you a flavour of the sorts of analysis that could be applied to these data. The analysis is necessarily incomplete and simplified because</p>
<ol style="list-style-type: decimal">
<li>we don’t have time in a single lab class to go through all the model evaluation we would need to do to assure ourselves that the inferences — the estimates from the models and associated intervals and <em>p</em> values — are valid and do not violate the assumptions of the methods we used, and</li>
<li>the statistical methods needed to fully analyze these data require techniques you won’t begin to cover until you take BIOL 440 <em>Modelling Biological Data</em> with Dr. Mark Vanderwel.</li>
</ol>
<p>Aspects of the data that we haven’t considered or simply ignored are:</p>
<ol style="list-style-type: decimal">
<li><p>What if the growth of the plants is non-linear? Our models assumed linear growth but if the growth appears to speed up or slow down over the course of the experiment, our model will give biased estimates of the growth rates.</p></li>
<li><p>We assumed that the individual measurements were independent of one another. However, you repeatedly measured the same plants, within your groups, over the course of the experiment. The observations for any one plant are, all else being equal, more likely to be similar to one another than they are to another plant. The result of repeatedly measuring the same individuals over time is that we have <strong>fewer</strong> observations than is implied by the number of rows in the data set. We would need to use a repeated measures ANOVA or, better still, a mixed modelling approach to account for the lack of independence. If you take BIOL 440 with Dr. Vanderwel you will learn about mixed models.</p></li>
<li><p>Variables such a plant height and fresh weight are continuous variables. They also have a fixed zero point — you can’t have a plant with negative height or weight (in fact you can’t measure a plant with <em>zero</em> height or weight either!). Data like this have what we call a <em>non-constant mean-variance relationship</em> — as we increase in height or weight we expect the variation about the mean or expected value to increase. Think about it, if we had a zero height plant there is no variation about that value as there is no plant. Hence as we increase height or weight the spread of the data must increase. This is known as <em>heteroscedasticity</em>. Also, we could extrapolate from our linear models and predict negative weight and height plants, which doesn’t make sense. The class of models called <strong>generalized linear models</strong> would allow us to handle these features of the data. You’ll learn about these models too if you take BIOL 440!</p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
